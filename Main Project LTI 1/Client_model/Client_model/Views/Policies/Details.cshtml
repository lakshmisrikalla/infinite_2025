@model Client_model.Models.Policy
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Policy Details";
}

<div class="container my-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
            <h3 class="mb-0">@Model.PolicyName</h3>
            <small class="text-muted">Policy details and documents</small>
        </div>
        <div>
            <a class="btn btn-outline-secondary me-2" href="@Url.Action("Index","Policies")"><i class="bi bi-arrow-left"></i> Back</a>
            <a class="btn btn-primary" href="@Url.Action("Edit","Policies", new { id = Model.PolicyID })"><i class="bi bi-pencil"></i> Edit</a>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-lg-8">
            <div class="card shadow-sm mb-3">
                <div class="card-body">
                    <dl class="row mb-0">
                        <dt class="col-sm-4 text-muted">Policy ID</dt>
                        <dd class="col-sm-8">@Model.PolicyID</dd>

                        <dt class="col-sm-4 text-muted">Policy Type</dt>
                        <dd class="col-sm-8">
                            @{
                                // Use ternary instead of null-conditional (?.) for older C# compatibility
                                var typeName = Model.PolicyType != null ? Model.PolicyType.TypeName : "—";
                            }
                            @typeName
                        </dd>

                        <dt class="col-sm-4 text-muted">Plan Kind</dt>
                        <dd class="col-sm-8">@Model.PlanKind</dd>

                        <dt class="col-sm-4 text-muted">Duration</dt>
                        <dd class="col-sm-8">@Model.DurationMonths months</dd>

                        <dt class="col-sm-4 text-muted">Base Premium</dt>
                        <dd class="col-sm-8">₹@String.Format("{0:N2}", Model.BasePremium)</dd>

                        <dt class="col-sm-4 text-muted">Status</dt>
                        <dd class="col-sm-8">@Model.Status</dd>

                        <dt class="col-sm-4 text-muted">Active</dt>
                        <dd class="col-sm-8">@(Model.IsActive ? "Yes" : "No")</dd>

                        <dt class="col-sm-4 text-muted">Created</dt>
                        <dd class="col-sm-8">@Model.CreatedAt.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</dd>
                    </dl>
                </div>
            </div>

            <div class="card shadow-sm">
                <div class="card-body">
                    <h5>Coverage Details</h5>
                    <p class="text-muted">@Html.Raw(string.IsNullOrWhiteSpace(Model.CoverageDetails) ? "<em>No coverage details provided.</em>" : Model.CoverageDetails)</p>

                    <h5 class="mt-3">Description</h5>
                    <p class="text-muted">@Html.Raw(string.IsNullOrWhiteSpace(Model.Description) ? "<em>No description provided.</em>" : Model.Description)</p>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card shadow-sm mb-3">
                <div class="card-body">
                    <h6>Documents</h6>
                    @{
                        var terms = ViewBag.TermsDoc;
                        if (terms != null)
                        {
                            // TermsDoc may be an EF object; render file name if present
                            var fileName = "";
                            try { fileName = terms.FileName ?? ""; } catch { fileName = ""; }
                            <div class="mb-2">
                                <strong>Terms:</strong>
                                <div class="small text-muted">@fileName</div>
                                <div class="mt-2">
                                    @* remove/download link if you don't have DownloadDocument implemented *@
                                    <a class="btn btn-sm btn-outline-primary" href="@Url.Action("DownloadDocument","Policies", new { id = terms.DocumentID })"><i class="bi bi-download"></i> Download</a>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="text-muted"><em>No terms uploaded.</em></div>
                        }
                    }
                </div>
            </div>

            <div class="card shadow-sm">
                <div class="card-body">
                    <h6>Quick actions</h6>
                    <a class="btn btn-sm btn-outline-primary w-100 mb-2" href="@Url.Action("Edit","Policies", new { id = Model.PolicyID })"><i class="bi bi-pencil"></i> Edit Policy</a>
                    <a class="btn btn-sm btn-outline-secondary w-100" href="@Url.Action("Index","Policies")"><i class="bi bi-list"></i> View All Policies</a>
                </div>
            </div>
        </div>
    </div>
</div>
